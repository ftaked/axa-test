Axa Direct Datalake Technical Test

【目的】
このテストの目的は、
業務で実際に使われるデータから、
あなたが習得している技術やスキルを活かし、
どのように課題を解決していくかを
確認する為のテストです。

課題を解決するための方法については、
正解も不正解もありませんが最終結果は正しい状態になるように努めて下さい。


【使用してほしい技術】
できれば、データを読むのはPythonまたはPysparkを利用して、
計算などはPythonかPysparkだけではなくSQLかNoSQLを使用してもかまいません。

※テスト内容を確認して、別のスクリプト言語を利用したい場合は、
テスト提出期限前までに、人事スタッフに確認してください。


【注意点】
課題を解決するために使用するすべてのコードや計算結果、
完成したデータセットを必ず提出してください。


【データセット】
基本的な形式のWebログデータをcsvファイルとして、
添付してあります。
以下が例です。 4 x列あります。

Action_time / Category　/ User_ID / URL

【課題】
csvファイルのデータをロードします。

User_IDごとのセッション(※1)にグループ化します。
※1:セッションの定義は後述

データをセッション化したら、セッションごとに次の変数に
計算結果を格納してください。

・session_duration
・couunt_total_url
・count_unique_url

【セッションの定義】
セッションの定義は、
「5分以上、非アクティブ期間が続いた状態」です。
例えばアクション１とアクション２の実行時の間に５分超えたら二つのセッションとなります。
次のアクションがない場合でも、
ユーザーはさらに60秒間だけ、アクティブであると想定しています。

例：
ユーザーが午前09:00:00にアクションを実行します。
次に午前9:04:59に別のアクションを実行します。
午前9:20:00に最終アクションを実行します。

その結果、
最初の2つのアクションは、セッション1に、
3番目のアクションはセッション2に
割り当てられます。

セッション1のsession_durationは5分59秒となります。

セッション2のsession_durationは60秒となります。
(後続のアクションがないため、セッションは60秒後に
タイムアウトすると想定されます。)

【最終結果】
最終結果のデータセットの形式は、
次の通りであることが望ましいです。

User_ID / session_number / session_start_time / session_duration / count_total_url / count_unique_url

【備考】
テクニカルテストに関するご質問は、AxaのHR担当者まで
お気軽にお送りください。



